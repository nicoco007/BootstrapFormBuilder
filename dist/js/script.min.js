"use strict";var BootstrapFormBuilder={currentLocale:"en",translations:{},init:function(){var a=this;$(".bsfb-form").each(function(){var t=$(this),r=t.data("locale");a.setLocale(r),t.addClass("js"),t.find('[type="submit"]').on("click",function(){$(this).attr("clicked","true")}),t.find("input, textarea").on("change",function(){window.onbeforeunload=function(e){return e.returnValue="no"}}),t.on("submit",function(e){e.preventDefault(),a.submitForm(t)}),t.find("[data-parent-value]").each(function(){var t=$(this),a=$('[name="'+t.data("parent")+'"]'),n=t.data("parent-value");a.on("change",function(){var e=a.val();"checkbox"===a.attr("type")?e=a.prop("checked"):"radio"===a.attr("type")&&(e=a.filter(":checked").val()),e===n?t.addClass("visible"):t.removeClass("visible")}).trigger("change")}),t.find("select").each(function(){a.dropdownSelect($(this))}),"function"==typeof $.fn.datetimepicker&&t.find(".datetimepicker-date").each(function(){var e=$(this),t=e.attr("id"),a=$('<div class="input-group date" data-target-input="nearest" id="'+t+'-wrapper">');a.append('<div class="input-group-prepend"><button type="button" class="btn btn-primary" data-target="#'+t+'-wrapper" data-toggle="datetimepicker"><i class="fa fa-calendar"></i></button></div>'),e.after(a),e.remove(),a.append(e);var n={format:"L",locale:r||"en"};e.data("min-date")&&(n.minDate=new Date(e.data("min-date"))),e.data("max-date")&&(n.maxDate=new Date(e.data("max-date"))),a.datetimepicker(n)}),"function"==typeof $.fn.intlTelInput&&t.find('input[type="tel"]').each(function(){var e=$(this),t=["US","CA"];e.data("pref-countries")&&(t=e.data("pref-countries").split(",")),e.intlTelInput({initialCountry:e.data("initial-country")||"US",preferredCountries:t})}),t.find('input[type="password"]').each(function(){a.showPassword($(this))}),"function"==typeof zxcvbn&&t.find('input[type="password"][data-show-strength="true"]').each(function(){a.passwordStrengthMeter($(this))})})},showPassword:function(a){for(var n=$('<input type="text" class="form-control" style="display: none" />'),e=$('<div class="input-group reveal-password"></div>'),t=$('<div class="input-group-append"></div>'),r=$('<button class="btn btn-primary" type="button"></button>'),s=["placeholder","minlength"],o=0;o<s.length;o++)n.attr(s[o],a.attr(s[o]));a.after(e),a.remove(),r.html('<i class="fa fa-eye"></i>'),t.append(r),e.append(a),e.append(n),e.append(t),r.on("click",function(){var e=r.find(".fa"),t="none"===a.css("display");a.css("display",t?"block":"none"),n.css("display",t?"none":"block"),e.removeClass("fa-eye fa-eye-slash"),e.addClass(t?"fa-eye":"fa-eye-slash")}),a.on("change keyup",function(){n.val(a.val())}),n.on("change keyup",function(){a.val(n.val())})},passwordStrengthMeter:function(e){var n=this,r={0:"danger",1:"danger",2:"warning",3:"info",4:"success"},s={0:"Very low",1:"Low",2:"Medium",3:"Good",4:"Excellent"},t=e.parent(),o=t.find("input"),a=$('<div class="input-container"></div>'),i=$('<div class="progress"></div>'),d=$('<div class="progress-bar" role="progressbar" style="width: 0" aria-valuenow="0" aria-valuemin="0" aria-valuemax="5"></div>'),l=$('<small class="form-text">'+n.translate("Password strength: ")+"</small>"),c=$("<span></span>"),p=$('<small class="form-text"></small>'),f=e.attr("minlength")||0;i.append(d),e.after(a),e.remove(),a.append(o),a.append(i),l.append(c),t.addClass("password-strength"),t.after(l),t.after(p);o.on("change keyup",function(){!function(e){var t=e.val();if(o.val(t),d.removeClass("bg-secondary bg-danger bg-warning bg-info bg-success"),c.removeClass("text-secondary text-danger text-warning text-info text-success"),p.removeClass("text-secondary text-danger text-warning text-info text-success"),t.length>=f){var a=zxcvbn(t.substr(0,100));d.addClass("bg-"+r[a.score]),c.addClass("text-"+r[a.score]),p.addClass("text-"+r[a.score]),d.width((a.score+1)/5*100+"%"),d.attr("aria-valuenow",a.score+1),c.text(n.translate(s[a.score])),p.text(n.translate(a.feedback.warning))}else 0<t.length?(d.addClass("bg-danger"),c.addClass("text-danger"),p.addClass("text-danger"),d.width("5%"),d.attr("aria-valuenow",1)):(d.addClass("bg-secondary"),c.addClass("text-secondary"),p.addClass("text-secondary"),d.width(0),d.attr("aria-valuenow",0)),c.text(n.translate("Too short")),p.text("")}($(this))}).trigger("change")},registerLocale:function(e,t){this.translations[e]=t},setLocale:function(e){var t=["en","fr"];e=e.toLowerCase(),-1<t.indexOf(e)&&(this.currentLocale=e),e=e.substr(0,2),t.indexOf(e)&&(this.currentLocale=e)},translate:function(e){if(this.translations[this.currentLocale]){if(this.translations[this.currentLocale][e])return this.translations[this.currentLocale][e];console.log('Unable to find localization for string "'+e+'"')}else console.log(this.currentLocale+" not loaded.");return e},dropdownSelect:function(a){var e=a.find("option"),t=a.attr("id")||a.attr("name"),n=$('<div class="dropdown bsfb-select">'),r=$('<button class="btn btn-light dropdown-toggle form-control" type="button" id="'+t+'-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-ref="'+t+'">'),s=$('<span class="select-text"></span>'),o=$('<span class="select-text-inner"></span>'),i=$('<div class="dropdown-menu" aria-labelledby="'+t+'-dropdown">');e.each(function(){var e=$(this),t=$('<span class="dropdown-item" data-value="'+e.val()+'">'+e.text()+"</span>");t.on("click",function(){a.val(t.data("value")),o.text(t.text())}),i.append(t)});var d=e.filter('[value="'+a.val()+'"]').first();d.length||(d=e.first()),o.text(d.text()),a.after(n),a.remove(),s.append(o),r.append(s),n.append(r),n.append(i),n.append(a)},submitForm:function(n){var r=this;n.find("fieldset, button").prop("disabled",!0),n.find("a").addClass("disabled"),n.find(".alert").remove();var e=n.find('button[type="submit"][clicked=true]');e.removeAttr("clicked");var t=e.children().first();t.is("i.fa")&&t.addClass("d-none"),e.prepend('<i class="fa fa-spinner fa-spin loader"></i> ');var a={ajax_submit:!0};a[e.attr("name")]=e.val(),n.find('input, textarea, select, button[type="button"]').each(function(){var e=$(this),t=e.parents(".form-group");e.removeClass("is-invalid"),t.find(".invalid-feedback").remove(),"checkbox"===e.attr("type")?a[e.attr("name")]=e.prop("checked")?"on":null:"radio"===e.attr("type")?e.prop("checked")&&(a[e.attr("name")]=e.val()):a[e.attr("name")]=e.val()}),$.ajax({method:n.attr("method"),contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:a,success:function(e){r.ajaxSuccess(n,e)},error:function(e,t,a){r.ajaxError(n,e,t,a)},complete:function(){r.ajaxComplete(n,e)}})},ajaxSuccess:function(e,t){if(!0===t.received)if(t.controlErrors)for(var a in t.controlErrors){var n=t.controlErrors[a],r=e.find('[name="'+a+'"], [data-ref="'+a+'"]').closest(".form-group");r.find(".form-control").addClass("is-invalid"),r.find(".input-group, .password-strength, .form-control, .custom-control:last").first().after('<div class="invalid-feedback d-block">'+n+"</div>")}else t.error?t.error.message?this.showAlert(e,t.error.message,"danger"):this.showAlert(e,this.translate("An unexpected server-side error occured. Please try again later."),"danger"):t.response?(this.showAlert(e,t.response.message,t.response.class,t.response.icon),t.success&&(window.onbeforeunload=null),t.response.redirect&&(window.location=t.response.redirect)):(this.showAlert(e,this.translate("Form submitted successfully."),"success"),window.onbeforeunload=null);else this.showAlert(e,this.translate("An unexpected server-side error occured. Please try again later."),"danger")},ajaxError:function(e,t,a,n){this.showAlert(e,this.translate("Unable to submit form: ")+n,"danger")},ajaxComplete:function(e,t){var a;t.find("i.fa.loader").remove(),t.children().first().removeClass("d-none");var n=e.find(".is-invalid:first").parents(".form-group");a=n.length?n.offset().top-10:e.offset().top-50,$("html, body").animate({scrollTop:a},100),e.find("fieldset, button").prop("disabled",!1),e.find("a").removeClass("disabled")},showAlert:function(e,t,a,n){var r=e.find(".form-title"),s='<div class="alert alert-'+(a||"info")+'">';n&&(s+='<i class="fa fa-'+n+'"></i>&nbsp;'),s+=t+"</div>",r.length?r.after(s):e.prepend(s)}};$(function(){BootstrapFormBuilder.init()});
//# sourceMappingURL=script.min.js.map