"use strict";var BootstrapFormBuilder={currentLocale:"en",translations:{},init:function(){var a=this;$(".bsfb-form").each(function(){var t=$(this),n=t.data("locale");a.setLocale(n),t.addClass("js"),t.find('[type="submit"]').on("click",function(){$(this).attr("clicked","true")}),t.find("input, textarea").on("change",function(){window.onbeforeunload=function(e){return e.returnValue="no"}}),t.on("submit",function(e){e.preventDefault(),a.submitForm(t)}),t.find(".datetimepicker-date").each(function(){var e=$(this),t=e.attr("id"),a=$('<div class="input-group date" data-target-input="nearest" id="'+t+'-wrapper">');a.append('<div class="input-group-prepend"><button type="button" class="btn btn-primary" data-target="#'+t+'-wrapper" data-toggle="datetimepicker"><i class="fa fa-calendar"></i></button></div>'),e.after(a),e.remove(),a.append(e);var r={format:"L",locale:n||"en"};e.data("min-date")&&(r.minDate=new Date(e.data("min-date"))),e.data("max-date")&&(r.maxDate=new Date(e.data("max-date"))),a.datetimepicker(r)}),t.find("select").each(function(){a.dropdownSelect($(this))}),t.find("[data-parent-value]").each(function(){var t=$(this),a=$('[name="'+t.data("parent")+'"]'),r=t.data("parent-value");a.on("change",function(){var e=a.val();"checkbox"===a.attr("type")?e=a.prop("checked"):"radio"===a.attr("type")&&(e=a.filter(":checked").val()),e===r?t.addClass("visible"):t.removeClass("visible")}).trigger("change")}),t.find('input[type="tel"]').each(function(){var e=$(this),t=["US","CA"];e.data("pref-countries")&&(t=e.data("pref-countries").split(",")),e.intlTelInput({initialCountry:e.data("initial-country")||"US",preferredCountries:t})})})},registerLocale:function(e,t){this.translations[e]=t},setLocale:function(e){var t=["en","fr"];e=e.toLowerCase(),-1<t.indexOf(e)&&(this.currentLocale=e),e=e.substr(0,2),t.indexOf(e)&&(this.currentLocale=e)},translate:function(e){if(this.translations[this.currentLocale]){if(this.translations[this.currentLocale][e])return this.translations[this.currentLocale][e];console.log('Unable to find localization for string "'+e+'"')}else console.log(this.currentLocale+" not loaded.");return e},dropdownSelect:function(a){var e=a.find("option"),t=a.attr("id")||a.attr("name"),r=$('<div class="dropdown bsfb-select">'),n=$('<button class="btn btn-light dropdown-toggle form-control" type="button" id="'+t+'-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-ref="'+t+'">'),i=$('<span class="select-text"></span>'),o=$('<span class="select-text-inner"></span>'),s=$('<div class="dropdown-menu" aria-labelledby="'+t+'-dropdown">');e.each(function(){var e=$(this),t=$('<span class="dropdown-item" data-value="'+e.val()+'">'+e.text()+"</span>");t.on("click",function(){a.val(t.data("value")),o.text(t.text())}),s.append(t)});var d=e.filter('[value="'+a.val()+'"]').first();d.length||(d=e.first()),o.text(d.text()),a.after(r),a.remove(),i.append(o),n.append(i),r.append(n),r.append(s),r.append(a)},submitForm:function(r){var n=this;r.find("fieldset, button").prop("disabled",!0),r.find("a").addClass("disabled"),r.find(".alert").remove();var e=r.find('button[type="submit"][clicked=true]');e.removeAttr("clicked");var t=e.children().first();t.is("i.fa")&&t.addClass("d-none"),e.prepend('<i class="fa fa-spinner fa-spin loader"></i> ');var a={ajax_submit:!0};a[e.attr("name")]=e.val(),r.find('input, textarea, select, button[type="button"]').each(function(){var e=$(this),t=e.parents(".form-group");e.removeClass("is-invalid"),t.find(".invalid-feedback").remove(),"checkbox"===e.attr("type")?a[e.attr("name")]=e.prop("checked")?"on":null:"radio"===e.attr("type")?e.prop("checked")&&(a[e.attr("name")]=e.val()):a[e.attr("name")]=e.val()}),$.ajax({method:r.attr("method"),contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:a,success:function(e){n.ajaxSuccess(r,e)},error:function(e,t,a){n.ajaxError(r,e,t,a)},complete:function(){n.ajaxComplete(r,e)}})},ajaxSuccess:function(e,t){if(!0===t.received)if(t.controlErrors)for(var a in t.controlErrors){var r=t.controlErrors[a],n=e.find('[name="'+a+'"], [data-ref="'+a+'"]'),i=n.closest(".form-group");n.addClass("is-invalid"),i.find(".input-group, .form-control, .custom-control:last").first().after('<div class="invalid-feedback d-block">'+r+"</div>")}else t.error?t.error.message?this.showAlert(e,t.error.message,"danger"):this.showAlert(e,this.translate("An unexpected server-side error occured. Please try again later."),"danger"):t.response?(this.showAlert(e,t.response.message,t.response.class,t.response.icon),t.success&&(window.onbeforeunload=null),t.response.redirect&&(window.location=t.response.redirect)):(this.showAlert(e,this.translate("Form submitted successfully."),"success"),window.onbeforeunload=null);else this.showAlert(e,this.translate("An unexpected server-side error occured. Please try again later."),"danger")},ajaxError:function(e,t,a,r){this.showAlert(e,this.translate("Unable to submit form: ")+r,"danger")},ajaxComplete:function(e,t){var a;t.find("i.fa.loader").remove(),t.children().first().removeClass("d-none");var r=e.find(".is-invalid:first").parents(".form-group");a=r.length?r.offset().top-10:e.offset().top-50,$("html, body").animate({scrollTop:a},100),e.find("fieldset, button").prop("disabled",!1),e.find("a").removeClass("disabled")},showAlert:function(e,t,a,r){var n=e.find(".form-title"),i='<div class="alert alert-'+(a||"info")+'">';r&&(i+='<i class="fa fa-'+r+'"></i>&nbsp;'),i+=t+"</div>",n.length?n.after(i):e.prepend(i)}};$(function(){BootstrapFormBuilder.init()});
//# sourceMappingURL=script.min.js.map